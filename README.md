# –û–±–º–µ–Ω –∏–≥—Ä—É—à–µ–∫ üß∏üîÑ

**–ú–æ–±–∏–ª—å–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–ª—è –æ–±–º–µ–Ω–∞ –∏–≥—Ä—É—à–∫–∞–º–∏ –º–µ–∂–¥—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏**

Android –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –Ω–∞ Kotlin —Å –±—ç–∫–µ–Ω–¥–æ–º –Ω–∞ Go –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è, —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∏ –æ–±–º–µ–Ω–∞ –∏–≥—Ä—É—à–∫–∞–º–∏.

---

## üìö –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø—Ä–æ–µ–∫—Ç–∞

### –û—Å–Ω–æ–≤–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è:

- **[ARCHITECTURE_DIAGRAMS.md](./ARCHITECTURE_DIAGRAMS.md)** - –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞
  - –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø–∞–ø–æ–∫ (MVC)
  - –î–∏–∞–≥—Ä–∞–º–º—ã –∫–ª–∞—Å—Å–æ–≤ –∏ –Ω–∞—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è
  - –ü—Ä–∏–Ω—Ü–∏–ø—ã SOLID –≤ –ø—Ä–æ–µ–∫—Ç–µ
  - –ü–∞—Ç—Ç–µ—Ä–Ω—ã –ø—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

- **[USER_SCENARIOS.md](./USER_SCENARIOS.md)** - –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏
  - –î–∏–∞–≥—Ä–∞–º–º—ã –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ (mermaid)
  - –í–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ: –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å ‚Üí UI ‚Üí Controller ‚Üí API ‚Üí DB
  - 10 –æ—Å–Ω–æ–≤–Ω—ã—Ö —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### API –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è:

- **[API_DOCUMENTATION.md](./API_DOCUMENTATION.md)** - –ü–æ–ª–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è API
  - –î–µ—Ç–∞–ª—å–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ endpoints
  - –ú–æ–¥–µ–ª–∏ –¥–∞–Ω–Ω—ã—Ö
  - –ü—Ä–∏–º–µ—Ä—ã –∑–∞–ø—Ä–æ—Å–æ–≤/–æ—Ç–≤–µ—Ç–æ–≤
  - –ö–æ–¥—ã –æ—à–∏–±–æ–∫

- **[API_QUICK_START.md](./API_QUICK_START.md)** - –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç —Å API
  - –ì–æ—Ç–æ–≤—ã–µ curl –ø—Ä–∏–º–µ—Ä—ã
  - –¢–∏–ø–∏—á–Ω—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏
  - Troubleshooting

- **[API_ENDPOINTS_TABLE.md](./API_ENDPOINTS_TABLE.md)** - –°–ø—Ä–∞–≤–æ—á–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞
  - –ö—Ä–∞—Ç–∫–∏–π –æ–±–∑–æ—Ä endpoints
  - Quick reference

---

## üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

### Android App (Kotlin)

```
app/src/main/java/course/exchange_toy/
‚îÇ
‚îú‚îÄ‚îÄ üé® views/              # VIEW - UI –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
‚îÇ   ‚îú‚îÄ‚îÄ BaseFragment.kt    # –ë–∞–∑–æ–≤—ã–π –∫–ª–∞—Å—Å –¥–ª—è –≤—Å–µ—Ö —Ñ—Ä–∞–≥–º–µ–Ω—Ç–æ–≤
‚îÇ   ‚îú‚îÄ‚îÄ *Fragment.kt       # –≠–∫—Ä–∞–Ω—ã –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
‚îÇ   ‚îú‚îÄ‚îÄ *Dialog.kt         # –î–∏–∞–ª–æ–≥–∏
‚îÇ   ‚îî‚îÄ‚îÄ *Adapter.kt        # RecyclerView –∞–¥–∞–ø—Ç–µ—Ä—ã
‚îÇ
‚îú‚îÄ‚îÄ üéÆ controller/         # CONTROLLER - –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞
‚îÇ   ‚îú‚îÄ‚îÄ UserController.kt
‚îÇ   ‚îú‚îÄ‚îÄ ToyController.kt
‚îÇ   ‚îî‚îÄ‚îÄ ExchangeController.kt
‚îÇ
‚îú‚îÄ‚îÄ üì¶ models/             # MODEL - –¥–∞–Ω–Ω—ã–µ
‚îÇ   ‚îú‚îÄ‚îÄ remote/            # API –º–æ–¥–µ–ª–∏ –∏ –∫–ª–∏–µ–Ω—Ç
‚îÇ   ‚îî‚îÄ‚îÄ user/              # –õ–æ–∫–∞–ª—å–Ω—ã–µ –º–æ–¥–µ–ª–∏
‚îÇ
‚îî‚îÄ‚îÄ üõ†Ô∏è utils/             # –£—Ç–∏–ª–∏—Ç—ã
    ‚îî‚îÄ‚îÄ Extensions.kt
```

### Backend (Go)

```
exchange_toys/
‚îú‚îÄ‚îÄ cmd/main.go           # Entry point
‚îú‚îÄ‚îÄ internal/
‚îÇ   ‚îú‚îÄ‚îÄ config/           # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
‚îÇ   ‚îú‚îÄ‚îÄ models/           # –ú–æ–¥–µ–ª–∏ –¥–∞–Ω–Ω—ã—Ö
‚îÇ   ‚îú‚îÄ‚îÄ service/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ handlers/     # HTTP handlers
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ middlewares/  # Middleware
‚îÇ   ‚îú‚îÄ‚îÄ storage/postgres/ # PostgreSQL
‚îÇ   ‚îî‚îÄ‚îÄ utils/            # –£—Ç–∏–ª–∏—Ç—ã
‚îî‚îÄ‚îÄ migrations/           # SQL –º–∏–≥—Ä–∞—Ü–∏–∏
```

---

## üöÄ –û—Å–Ω–æ–≤–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

### –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è
- ‚úÖ –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- ‚úÖ –í—Ö–æ–¥ –≤ —Å–∏—Å—Ç–µ–º—É
- ‚úÖ –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Å–µ—Å—Å–∏–∏ (SharedPreferences)
- ‚úÖ –í—ã—Ö–æ–¥ –∏–∑ —Å–∏—Å—Ç–µ–º—ã

### –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∏–≥—Ä—É—à–∫–∞–º–∏
- ‚úÖ –°–æ–∑–¥–∞–Ω–∏–µ –∏–≥—Ä—É—à–∫–∏ (—Å —Ñ–æ—Ç–æ –∏–ª–∏ –±–µ–∑)
- ‚úÖ –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ (–Ω–∞–∑–≤–∞–Ω–∏–µ, –æ–ø–∏—Å–∞–Ω–∏–µ, —Ñ–æ—Ç–æ)
- ‚úÖ –£–¥–∞–ª–µ–Ω–∏–µ (soft delete)
- ‚úÖ –ü—Ä–æ—Å–º–æ—Ç—Ä –¥–µ—Ç–∞–ª–µ–π
- ‚úÖ –°–ø–∏—Å–æ–∫ —Å–≤–æ–∏—Ö –∏–≥—Ä—É—à–µ–∫ (cursor-based –ø–∞–≥–∏–Ω–∞—Ü–∏—è)
- ‚úÖ –ò–∑–º–µ–Ω–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞ (`created` ‚Üî `exchanging`)
- ‚úÖ –ó–∞–≥—Ä—É–∑–∫–∞ –∏ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–π

### –û–±–º–µ–Ω—ã
- ‚úÖ –°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è –æ–±–º–µ–Ω–∞
- ‚úÖ –ü—Ä–æ—Å–º–æ—Ç—Ä –¥–µ—Ç–∞–ª–µ–π –æ–±–º–µ–Ω–∞
- ‚úÖ –î–≤—É—Ö—ç—Ç–∞–ø–Ω–æ–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ (confirm_1 ‚Üí confirm_2)
  - –≠—Ç–∞–ø 1: "–°–ø–∏—Å–∞—Ç—å—Å—è" (–æ–±–µ —Å—Ç–æ—Ä–æ–Ω—ã)
  - –≠—Ç–∞–ø 2: "–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å –æ–±–º–µ–Ω" (–æ–±–µ —Å—Ç–æ—Ä–æ–Ω—ã)
- ‚úÖ –û—Ç–º–µ–Ω–∞ –æ–±–º–µ–Ω–∞ (–ª—é–±–æ–π —É—á–∞—Å—Ç–Ω–∏–∫)
- ‚úÖ –°–ø–∏—Å–æ–∫ –æ–±–º–µ–Ω–æ–≤ (–ø–∞–≥–∏–Ω–∞—Ü–∏—è)
- ‚úÖ Email —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –ø—Ä–∏ —É—Å–ø–µ—à–Ω–æ–º –æ–±–º–µ–Ω–µ

### –ú–∞–≥–∞–∑–∏–Ω
- ‚úÖ –ü—Ä–æ—Å–º–æ—Ç—Ä –∏–≥—Ä—É—à–µ–∫ –¥—Ä—É–≥–∏—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- ‚úÖ –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è (—Ç–æ–ª—å–∫–æ `exchanging` —Å—Ç–∞—Ç—É—Å)
- ‚úÖ Cursor-based –ø–∞–≥–∏–Ω–∞—Ü–∏—è

### –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ —Ñ–∏—á–∏
- ‚úÖ **–ò–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å** –¥–ª—è create –æ–ø–µ—Ä–∞—Ü–∏–π
- ‚úÖ **Retry –º–µ—Ö–∞–Ω–∏–∑–º** (–¥–æ 3 —Ä–∞–∑ —Å –æ–¥–Ω–∏–º —Ç–æ–∫–µ–Ω–æ–º)
- ‚úÖ **ViewBinding** –¥–ª—è –≤—Å–µ—Ö —Ñ—Ä–∞–≥–º–µ–Ω—Ç–æ–≤
- ‚úÖ **BaseFragment** —Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–æ–π window insets
- ‚úÖ **Extension —Ñ—É–Ω–∫—Ü–∏–∏** –¥–ª—è –ø–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –∫–æ–¥–∞
- ‚úÖ **–¢–µ–º–Ω–∞—è —Ç–µ–º–∞** (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ)
- ‚úÖ **Edge-to-edge** UI —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º–∏ –æ—Ç—Å—Ç—É–ø–∞–º–∏
- ‚úÖ **Material Design 3**

---

## üõ†Ô∏è –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏

### Android
- **Kotlin** - –æ—Å–Ω–æ–≤–Ω–æ–π —è–∑—ã–∫
- **Ktor Client** - HTTP –∫–ª–∏–µ–Ω—Ç
- **Coil** - –∑–∞–≥—Ä—É–∑–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
- **ViewBinding** - –ø—Ä–∏–≤—è–∑–∫–∞ View
- **Coroutines** - –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ—Å—Ç—å
- **Material Design 3** - UI –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
- **SharedPreferences** - –ª–æ–∫–∞–ª—å–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ
- **RecyclerView** —Å `ListAdapter` - —Å–ø–∏—Å–∫–∏ —Å DiffUtil

### Backend
- **Go 1.21+**
- **Fiber v2** - web framework
- **PostgreSQL** - –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
- **bcrypt** - —Ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–∞—Ä–æ–ª–µ–π
- **UUID** - –≥–µ–Ω–µ—Ä–∞—Ü–∏—è ID
- **Base64** - –∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ –∫—É—Ä—Å–æ—Ä–æ–≤ –¥–ª—è –ø–∞–≥–∏–Ω–∞—Ü–∏–∏

---

## üì¶ –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –ó–∞–ø—É—Å–∫

### Backend

1. **–£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:**
```bash
cd exchange_toys
go mod download
```

2. **–ù–∞—Å—Ç—Ä–æ–∏—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é:**
```yaml
# config/local_config.yaml
server:
  host: "0.0.0.0"
  port: 8080
  prefix_upload: "./upload"
  photo_url: "http://localhost:8080/upload"

postgres:
  host: "localhost"
  port: 5432
  database: "exchange_toys"
  username: "postgres"
  password: "password"
```

3. **–ó–∞–ø—É—Å—Ç–∏—Ç—å PostgreSQL:**
```bash
# –ß–µ—Ä–µ–∑ Docker
docker-compose up -d postgres

# –ò–ª–∏ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ª–æ–∫–∞–ª—å–Ω–æ
```

4. **–ü—Ä–∏–º–µ–Ω–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏–∏:**
```bash
psql -U postgres -d exchange_toys -f migrations/create_entity.sql
psql -U postgres -d exchange_toys -f migrations/test_data.sql  # optional
```

5. **–ó–∞–ø—É—Å—Ç–∏—Ç—å —Å–µ—Ä–≤–µ—Ä:**
```bash
CONFIG_PATH=./config/local_config.yaml go run ./cmd/main.go
```

–°–µ—Ä–≤–µ—Ä –∑–∞–ø—É—Å—Ç–∏—Ç—Å—è –Ω–∞ `http://localhost:8080`

### Android App

1. **–û—Ç–∫—Ä—ã—Ç—å –ø—Ä–æ–µ–∫—Ç –≤ Android Studio**

2. **–ù–∞—Å—Ç—Ä–æ–∏—Ç—å API host –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –∑–∞–ø—É—Å–∫–µ:**
- –≠–º—É–ª—è—Ç–æ—Ä: `http://10.0.2.2:8080`
   - –†–µ–∞–ª—å–Ω–æ–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ: `http://192.168.1.XXX:8080` (IP –∫–æ–º–ø—å—é—Ç–µ—Ä–∞)

3. **–°–æ–±—Ä–∞—Ç—å –∏ –∑–∞–ø—É—Å—Ç–∏—Ç—å:**
```bash
./gradlew assembleDebug
# –∏–ª–∏ —á–µ—Ä–µ–∑ Android Studio: Run 'app'
```

---

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ API

### –ü—Ä–∏–º–µ—Ä—ã —Å curl

**–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è:**
```bash
curl -X POST http://localhost:8080/v1/register \
  -H "Content-Type: application/json" \
  -d '{
    "user_name": {
      "first_name": "–ò–≤–∞–Ω",
      "last_name": "–ò–≤–∞–Ω–æ–≤"
    },
    "email": "test@test.com",
    "password": "pass123",
    "confirm_password": "pass123"
  }'
```

**–°–æ–∑–¥–∞–Ω–∏–µ –∏–≥—Ä—É—à–∫–∏:**
```bash
curl -X POST http://localhost:8080/v1/toys/ \
  -H "x_user_id: YOUR_USER_ID" \
  -H "x_idempotency_token: $(uuidgen)" \
  -F "name=–ú–∞—à–∏–Ω–∫–∞" \
  -F "description=–ö—Ä–∞—Å–Ω–∞—è –≥–æ–Ω–æ—á–Ω–∞—è" \
  -F "file=@photo.jpg"
```

–ë–æ–ª—å—à–µ –ø—Ä–∏–º–µ—Ä–æ–≤ ‚Üí [API_QUICK_START.md](./API_QUICK_START.md)

---

## üîë –ö–ª—é—á–µ–≤—ã–µ –∫–æ–Ω—Ü–µ–ø—Ü–∏–∏

### 1. –ò–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å

–û–ø–µ—Ä–∞—Ü–∏–∏ —Å–æ–∑–¥–∞–Ω–∏—è (POST /toys/, POST /exchange/) —Ç—Ä–µ–±—É—é—Ç `x_idempotency_token`.
–ü—Ä–∏ –ø–æ–≤—Ç–æ—Ä–Ω–æ–º –∑–∞–ø—Ä–æ—Å–µ —Å —Ç–µ–º –∂–µ —Ç–æ–∫–µ–Ω–æ–º –≤–µ—Ä–Ω–µ—Ç—Å—è —É–∂–µ —Å–æ–∑–¥–∞–Ω–Ω—ã–π –æ–±—ä–µ–∫—Ç.

```kotlin
// –í ApiClient –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è UUID
val token = UUID.randomUUID().toString()
```

**Retry –º–µ—Ö–∞–Ω–∏–∑–º:**
- –î–æ 3 –ø–æ–ø—ã—Ç–æ–∫ –ø—Ä–∏ —Å–µ—Ç–µ–≤—ã—Ö –æ—à–∏–±–∫–∞—Ö
- **–û–¥–∏–Ω –∏ —Ç–æ—Ç –∂–µ —Ç–æ–∫–µ–Ω** –¥–ª—è –≤—Å–µ—Ö –ø–æ–ø—ã—Ç–æ–∫
- –ì–∞—Ä–∞–Ω—Ç–∏—è –æ—Ç—Å—É—Ç—Å—Ç–≤–∏—è –¥—É–±–ª–∏–∫–∞—Ç–æ–≤

### 2. Cursor-based –ø–∞–≥–∏–Ω–∞—Ü–∏—è

```json
{
  "items": [...],
  "cursor": "base64_encoded_cursor"  // null –Ω–∞ –ø–æ—Å–ª–µ–¥–Ω–µ–π —Å—Ç—Ä–∞–Ω–∏—Ü–µ
}
```

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- –≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ –¥–ª—è –±–æ–ª—å—à–∏—Ö –æ–±—ä–µ–º–æ–≤
- –ù–µ—Ç –¥—É–±–ª–∏–∫–∞—Ç–æ–≤ –ø—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ –Ω–æ–≤—ã—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤
- –°—Ç–∞–±–∏–ª—å–Ω–∞—è –ø–∞–≥–∏–Ω–∞—Ü–∏—è

### 3. –°—Ç–∞—Ç—É—Å—ã –∏–≥—Ä—É—à–µ–∫

```
created     ‚îÄ‚îÄPATCH‚îÄ‚îÄ>  exchanging
    ‚ñ≤                       ‚îÇ
    ‚îÇ                       ‚îÇ
    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄPATCH‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
              ‚îÇ
           DELETE
              ‚ñº
          removed (—Ç–µ—Ä–º–∏–Ω–∞–ª—å–Ω—ã–π)
```

### 4. –ü–æ—Ç–æ–∫ –æ–±–º–µ–Ω–∞

```
created  ‚Üí  confirm_1  ‚Üí  confirm_2  ‚Üí  confirm  ‚úÖ
   ‚îÇ                                        ‚Üì
   ‚îÇ                                    success
   ‚îÇ
   ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ> failed ‚ùå (–æ—Ç–º–µ–Ω–∞)
```

**–î–≤—É—Ö—ç—Ç–∞–ø–Ω–æ–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ:**
1. **–≠—Ç–∞–ø "–°–ø–∏—Å–∞—Ç—å—Å—è"** (`confirm_1`) - –æ–±–µ —Å—Ç–æ—Ä–æ–Ω—ã –≥–æ—Ç–æ–≤—ã –∫ –∫–æ–Ω—Ç–∞–∫—Ç—É
2. **–≠—Ç–∞–ø "–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å –æ–±–º–µ–Ω"** (`confirm_2`) - —Ñ–∏–Ω–∞–ª—å–Ω–æ–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ
3. **–£—Å–ø–µ—Ö** (`success`) - –æ—Ç–ø—Ä–∞–≤–∫–∞ email –æ–±–æ–∏–º —É—á–∞—Å—Ç–Ω–∏–∫–∞–º

---

## üéØ –ü—Ä–∏–Ω—Ü–∏–ø—ã SOLID –≤ –ø—Ä–æ–µ–∫—Ç–µ

‚úÖ **S - Single Responsibility**: –ö–∞–∂–¥—ã–π Controller –æ—Ç–≤–µ—á–∞–µ—Ç –∑–∞ —Å–≤–æ—é –æ–±–ª–∞—Å—Ç—å  
‚úÖ **O - Open/Closed**: BaseFragment –æ—Ç–∫—Ä—ã—Ç –¥–ª—è —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è, –∑–∞–∫—Ä—ã—Ç –¥–ª—è –º–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏–∏  
‚úÖ **L - Liskov Substitution**: –í—Å–µ —Ñ—Ä–∞–≥–º–µ–Ω—Ç—ã –≤–∑–∞–∏–º–æ–∑–∞–º–µ–Ω—è–µ–º—ã  
‚úÖ **I - Interface Segregation**: –û—Ç–¥–µ–ª—å–Ω—ã–µ callback –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π  
‚úÖ **D - Dependency Inversion**: Controllers –∑–∞–≤–∏—Å—è—Ç –æ—Ç –∞–±—Å—Ç—Ä–∞–∫—Ü–∏–π (ApiClient)

–ü–æ–¥—Ä–æ–±–Ω–µ–µ ‚Üí [ARCHITECTURE_DIAGRAMS.md](./ARCHITECTURE_DIAGRAMS.md)

---

## üìù –ò—Å—Ç–æ—Ä–∏—è —É–ª—É—á—à–µ–Ω–∏–π

### –†–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ –∫–æ–¥–æ–≤–æ–π –±–∞–∑—ã:

1. ‚úÖ **–°–æ–∑–¥–∞–Ω BaseFragment<VB>**
   - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ ViewBinding
   - –û–±—Ä–∞–±–æ—Ç–∫–∞ window insets –¥–ª—è –≤—Å–µ—Ö —Ñ—Ä–∞–≥–º–µ–Ω—Ç–æ–≤
   - –°–æ–∫—Ä–∞—â–µ–Ω–∏–µ –∫–æ–¥–∞ –Ω–∞ 20-50% –≤ –∫–∞–∂–¥–æ–º —Ñ—Ä–∞–≥–º–µ–Ω—Ç–µ

2. ‚úÖ **Extension —Ñ—É–Ω–∫—Ü–∏–∏** (Extensions.kt)
   - `Fragment.showToast()` / `showLongToast()`
   - `UserSession.createApiClient()`
   - –ï–¥–∏–Ω–æ–æ–±—Ä–∞–∑–∏–µ –∫–æ–¥–∞

3. ‚úÖ **–ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Ç–µ–º–Ω–æ–π —Ç–µ–º—ã**
   - –ó–∞–º–µ–Ω–∞ –∂–µ—Å—Ç–∫–∏—Ö —Ü–≤–µ—Ç–æ–≤ –Ω–∞ –∞—Ç—Ä–∏–±—É—Ç—ã —Ç–µ–º—ã
   - –ê–¥–∞–ø—Ç–∞—Ü–∏—è –≤—Å–µ—Ö —Ñ—Ä–∞–≥–º–µ–Ω—Ç–æ–≤ –∏ –¥–∏–∞–ª–æ–≥–æ–≤
   - –¶–≤–µ—Ç–∞ —Å—Ç–∞—Ç—É—Å–æ–≤ –æ—Å—Ç–∞–ª–∏—Å—å —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–º–∏ (—Å–µ–º–∞–Ω—Ç–∏–∫–∞)

4. ‚úÖ **Edge-to-edge UI**
   - –ü—Ä–∞–≤–∏–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ system bars
   - –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –∂–µ—Å—Ç–æ–≤–æ–π –Ω–∞–≤–∏–≥–∞—Ü–∏–∏
   - –†–∞–±–æ—Ç–∞ —Å –≤—ã—Ä–µ–∑–∞–º–∏ —ç–∫—Ä–∞–Ω–∞

5. ‚úÖ **–£–¥–∞–ª–µ–Ω—ã –¥—É–±–ª–∏—Ä—É—é—â–∏–µ—Å—è —Ñ–∞–π–ª—ã**
   - –û—á–∏—â–µ–Ω–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞
   - –£–±—Ä–∞–Ω –º–µ—Ä—Ç–≤—ã–π –∫–æ–¥

---

## ü§ù API Contract

### Headers –¥–ª—è –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤:

```
x_user_id: {uuid}           # Required –¥–ª—è –≤—Å–µ—Ö endpoints –∫—Ä–æ–º–µ auth
x_idempotency_token: {uuid} # Required –¥–ª—è POST /toys/, POST /exchange/
toy_id: {uuid}              # Required –¥–ª—è POST /toys/change
```

### –ú–æ–¥–µ–ª–∏ –¥–∞–Ω–Ω—ã—Ö:

–°–º. [API_DOCUMENTATION.md](./API_DOCUMENTATION.md)

---

## üìû –ü–æ–ª–Ω—ã–π flow –æ–±–º–µ–Ω–∞ (–ø—Ä–∏–º–µ—Ä)

1. **User 1**: –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è ‚Üí `{user_id: "user-1"}`
2. **User 1**: –°–æ–∑–¥–∞–Ω–∏–µ –∏–≥—Ä—É—à–∫–∏ ‚Üí `{toy_id: "toy-1", status: "created"}`
3. **User 1**: –í—ã—Å—Ç–∞–≤–∏—Ç—å –Ω–∞ –æ–±–º–µ–Ω ‚Üí `PATCH status: "exchanging"`
4. **User 1**: –°–æ–∑–¥–∞—Ç—å –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ –æ–±–º–µ–Ω–∞ ‚Üí `{exchange_id: "exch-1"}`
5. **User 1**: –ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å (—Å–ø–∏—Å–∞—Ç—å—Å—è) ‚Üí `PATCH status: "confirm_1"`
6. **User 2**: –ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å (—Å–ø–∏—Å–∞—Ç—å—Å—è) ‚Üí `PATCH status: "confirm_1"`
7. **User 1**: –ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å –æ–±–º–µ–Ω ‚Üí `PATCH status: "confirm_2"`
8. **User 2**: –ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å –æ–±–º–µ–Ω ‚Üí `PATCH status: "confirm_2"`
9. **Backend**: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ ‚Üí `status: "success"` + Email –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω—ã! ‚úâÔ∏è

---

## üêõ Known Issues

1. **Login endpoint** –≤ `cmd/main.go` (—Å—Ç—Ä–æ–∫–∞ 75):
   ```go
   app.Post("v1/login", ...)  // ‚ùå Missing leading slash
   ```
   –î–æ–ª–∂–Ω–æ –±—ã—Ç—å: `app.Post("/v1/login", ...)`

2. –ù–µ—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ç–∏–ø–æ–≤ —Ñ–∞–π–ª–æ–≤ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Ñ–æ—Ç–æ
3. –ù–µ—Ç –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è —Ä–∞–∑–º–µ—Ä–∞ –∑–∞–≥—Ä—É–∂–∞–µ–º—ã—Ö —Ñ–∞–π–ª–æ–≤

---

## üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø—Ä–æ–µ–∫—Ç–∞

### Android:
- **28 Kotlin —Ñ–∞–π–ª–æ–≤**
- **16 XML layout —Ñ–∞–π–ª–æ–≤**
- **9 Fragment'–æ–≤** (–Ω–∞—Å–ª–µ–¥–Ω–∏–∫–∏ BaseFragment)
- **3 Adapter'–∞** (RecyclerView)
- **3 Controller'–∞** (–±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞)

### Backend:
- **Go –º–æ–¥—É–ª–µ–π**: Config, Models, Handlers, Storage, Utils
- **Endpoints**: 11 (auth: 2, toys: 6, exchanges: 4)
- **–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö**: 4 —Ç–∞–±–ª–∏—Ü—ã (users, toys, exchanges, exchange_details)

---

## üìö –ü–æ–ª–µ–∑–Ω—ã–µ —Å—Å—ã–ª–∫–∏

- [Kotlin Documentation](https://kotlinlang.org/docs/)
- [Ktor Client](https://ktor.io/docs/client.html)
- [Android Developers](https://developer.android.com/)
- [Material Design 3](https://m3.material.io/)
- [Fiber Framework](https://docs.gofiber.io/)

---

## üìÑ License

MIT License - —Å–≤–æ–±–æ–¥–Ω–æ –¥–ª—è –æ–±—Ä–∞–∑–æ–≤–∞—Ç–µ–ª—å–Ω—ã—Ö —Ü–µ–ª–µ–π.

---

**–ü—Ä–æ–µ–∫—Ç –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–µ –ø–æ–¥—Ö–æ–¥—ã –∫ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ Android –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π —Å –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ–º –ø—Ä–∏–Ω—Ü–∏–ø–æ–≤ —á–∏—Å—Ç–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã –∏ SOLID.**
